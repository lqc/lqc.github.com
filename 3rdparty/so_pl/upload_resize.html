<!DOCTYPE html> 
<html>
<head>
  <title>AJAX Upload with Image resize</title>
  <style type="text/css">
    #canvas {
      border: 2px solid black;
    } 
  </style>
</head>
<body>
  <form method="POST" action="/upload">
    <input type="file" id="uploader">
  </form>
  <canvas id="canvas" width="100" height="100"></canvas>
</body>
<script type="text/javascript">
(function() {
    var canvas = document.getElementById("canvas");
    function prepare_thumbnails() {
        var image_file = this.files[0];
        var reader = new FileReader();

        reader.readAsDataURL(image_file);
        reader.onload = function paint_thumbnail(evt) {
            var img = new Image();
            img.src = evt.target.result;
            canvas.getContext("2d").drawImage(image_file.getDataURL(), 0, 0, 100, 100);
        };
        reader.onerror = function load_error() {
            console.log("Failed to load file:", arguments);
        }; 
    };
    var file_input = document.getElementById("uploader"); 
    file_input.onchange = prepare_thumbnails;
})();
</script>
</html>
